20221125-003118
0.10870671272277832
898509
mask_bn_channel_dict
{'backbone.backbone.stem.conv.bn': 9, 'backbone.backbone.dark2.0.dconv.bn': 5, 'backbone.backbone.dark2.0.pconv.bn': 32, 'backbone.backbone.dark2.1.conv1.bn': 12, 'backbone.backbone.dark2.1.conv2.bn': 16, 'backbone.backbone.dark2.1.conv3.bn': 10, 'backbone.backbone.dark2.1.m.0.conv1.bn': 1, 'backbone.backbone.dark2.1.m.0.conv2.dconv.bn': 16, 'backbone.backbone.dark2.1.m.0.conv2.pconv.bn': 15, 'backbone.backbone.dark3.0.dconv.bn': 32, 'backbone.backbone.dark3.0.pconv.bn': 64, 'backbone.backbone.dark3.1.conv1.bn': 8, 'backbone.backbone.dark3.1.conv2.bn': 30, 'backbone.backbone.dark3.1.conv3.bn': 39, 'backbone.backbone.dark3.1.m.0.conv1.bn': 6, 'backbone.backbone.dark3.1.m.0.conv2.dconv.bn': 26, 'backbone.backbone.dark3.1.m.0.conv2.pconv.bn': 21, 'backbone.backbone.dark3.1.m.1.conv1.bn': 11, 'backbone.backbone.dark3.1.m.1.conv2.dconv.bn': 22, 'backbone.backbone.dark3.1.m.1.conv2.pconv.bn': 25, 'backbone.backbone.dark3.1.m.2.conv1.bn': 15, 'backbone.backbone.dark3.1.m.2.conv2.dconv.bn': 8, 'backbone.backbone.dark3.1.m.2.conv2.pconv.bn': 23, 'backbone.backbone.dark4.0.dconv.bn': 1, 'backbone.backbone.dark4.0.pconv.bn': 123, 'backbone.backbone.dark4.1.conv1.bn': 16, 'backbone.backbone.dark4.1.conv2.bn': 64, 'backbone.backbone.dark4.1.conv3.bn': 108, 'backbone.backbone.dark4.1.m.0.conv1.bn': 13, 'backbone.backbone.dark4.1.m.0.conv2.dconv.bn': 52, 'backbone.backbone.dark4.1.m.0.conv2.pconv.bn': 33, 'backbone.backbone.dark4.1.m.1.conv1.bn': 38, 'backbone.backbone.dark4.1.m.1.conv2.dconv.bn': 30, 'backbone.backbone.dark4.1.m.1.conv2.pconv.bn': 44, 'backbone.backbone.dark4.1.m.2.conv1.bn': 42, 'backbone.backbone.dark4.1.m.2.conv2.dconv.bn': 7, 'backbone.backbone.dark4.1.m.2.conv2.pconv.bn': 61, 'backbone.backbone.dark5.0.dconv.bn': 11, 'backbone.backbone.dark5.0.pconv.bn': 256, 'backbone.backbone.dark5.1.conv1.bn': 127, 'backbone.backbone.dark5.1.conv2.bn': 234, 'backbone.backbone.dark5.2.conv1.bn': 128, 'backbone.backbone.dark5.2.conv2.bn': 128, 'backbone.backbone.dark5.2.conv3.bn': 254, 'backbone.backbone.dark5.2.m.0.conv1.bn': 71, 'backbone.backbone.dark5.2.m.0.conv2.dconv.bn': 123, 'backbone.backbone.dark5.2.m.0.conv2.pconv.bn': 128, 'backbone.lateral_conv0.bn': 126, 'backbone.C3_p4.conv1.bn': 59, 'backbone.C3_p4.conv2.bn': 62, 'backbone.C3_p4.conv3.bn': 121, 'backbone.C3_p4.m.0.conv1.bn': 40, 'backbone.C3_p4.m.0.conv2.dconv.bn': 26, 'backbone.C3_p4.m.0.conv2.pconv.bn': 64, 'backbone.reduce_conv1.bn': 54, 'backbone.C3_p3.conv1.bn': 18, 'backbone.C3_p3.conv2.bn': 15, 'backbone.C3_p3.conv3.bn': 28, 'backbone.C3_p3.m.0.conv1.bn': 11, 'backbone.C3_p3.m.0.conv2.dconv.bn': 15, 'backbone.C3_p3.m.0.conv2.pconv.bn': 30, 'backbone.bu_conv2.dconv.bn': 9, 'backbone.bu_conv2.pconv.bn': 64, 'backbone.C3_n3.conv1.bn': 64, 'backbone.C3_n3.conv2.bn': 62, 'backbone.C3_n3.conv3.bn': 116, 'backbone.C3_n3.m.0.conv1.bn': 34, 'backbone.C3_n3.m.0.conv2.dconv.bn': 32, 'backbone.C3_n3.m.0.conv2.pconv.bn': 64, 'backbone.bu_conv1.dconv.bn': 102, 'backbone.bu_conv1.pconv.bn': 128, 'backbone.C3_n4.conv1.bn': 128, 'backbone.C3_n4.conv2.bn': 128, 'backbone.C3_n4.conv3.bn': 256, 'backbone.C3_n4.m.0.conv1.bn': 125, 'backbone.C3_n4.m.0.conv2.dconv.bn': 128, 'backbone.C3_n4.m.0.conv2.pconv.bn': 128, 'head.cls_convs.0.0.dconv.bn': 64, 'head.cls_convs.0.0.pconv.bn': 64, 'head.cls_convs.0.1.dconv.bn': 64, 'head.cls_convs.0.1.pconv.bn': 64, 'head.cls_convs.1.0.dconv.bn': 64, 'head.cls_convs.1.0.pconv.bn': 64, 'head.cls_convs.1.1.dconv.bn': 64, 'head.cls_convs.1.1.pconv.bn': 64, 'head.cls_convs.2.0.dconv.bn': 64, 'head.cls_convs.2.0.pconv.bn': 64, 'head.cls_convs.2.1.dconv.bn': 64, 'head.cls_convs.2.1.pconv.bn': 64, 'head.reg_convs.0.0.dconv.bn': 64, 'head.reg_convs.0.0.pconv.bn': 64, 'head.reg_convs.0.1.dconv.bn': 64, 'head.reg_convs.0.1.pconv.bn': 64, 'head.reg_convs.1.0.dconv.bn': 64, 'head.reg_convs.1.0.pconv.bn': 64, 'head.reg_convs.1.1.dconv.bn': 64, 'head.reg_convs.1.1.pconv.bn': 64, 'head.reg_convs.2.0.dconv.bn': 64, 'head.reg_convs.2.0.pconv.bn': 64, 'head.reg_convs.2.1.dconv.bn': 64, 'head.reg_convs.2.1.pconv.bn': 64, 'head.stems.0.bn': 64, 'head.stems.1.bn': 64, 'head.stems.2.bn': 64}
Case 1

backbone
backbone.backbone
backbone.backbone.stem
backbone.backbone.stem.conv
backbone.backbone.stem.conv.conv
backbone.backbone.stem.conv.bn
backbone.backbone.stem.conv.act
backbone.backbone.dark2
backbone.backbone.dark2.0
backbone.backbone.dark2.0.conv
backbone.backbone.dark2.0.bn
backbone.backbone.dark2.0.act
backbone.backbone.dark2.1
backbone.backbone.dark2.1.conv1
backbone.backbone.dark2.1.conv1.conv
backbone.backbone.dark2.1.conv1.bn
backbone.backbone.dark2.1.conv1.act
backbone.backbone.dark2.1.conv2
backbone.backbone.dark2.1.conv2.conv
backbone.backbone.dark2.1.conv2.bn
backbone.backbone.dark2.1.conv2.act
backbone.backbone.dark2.1.conv3
backbone.backbone.dark2.1.conv3.conv
backbone.backbone.dark2.1.conv3.bn
backbone.backbone.dark2.1.conv3.act
backbone.backbone.dark2.1.m
backbone.backbone.dark2.1.m.0
backbone.backbone.dark2.1.m.0.conv1
backbone.backbone.dark2.1.m.0.conv1.conv
backbone.backbone.dark2.1.m.0.conv1.bn
backbone.backbone.dark2.1.m.0.conv1.act
backbone.backbone.dark2.1.m.0.conv2
backbone.backbone.dark2.1.m.0.conv2.conv
backbone.backbone.dark2.1.m.0.conv2.bn
backbone.backbone.dark2.1.m.0.conv2.act
backbone.backbone.dark3
backbone.backbone.dark3.0
backbone.backbone.dark3.0.conv
backbone.backbone.dark3.0.bn
backbone.backbone.dark3.0.act
backbone.backbone.dark3.1
backbone.backbone.dark3.1.conv1
backbone.backbone.dark3.1.conv1.conv
backbone.backbone.dark3.1.conv1.bn
backbone.backbone.dark3.1.conv1.act
backbone.backbone.dark3.1.conv2
backbone.backbone.dark3.1.conv2.conv
backbone.backbone.dark3.1.conv2.bn
backbone.backbone.dark3.1.conv2.act
backbone.backbone.dark3.1.conv3
backbone.backbone.dark3.1.conv3.conv
backbone.backbone.dark3.1.conv3.bn
backbone.backbone.dark3.1.conv3.act
backbone.backbone.dark3.1.m
backbone.backbone.dark3.1.m.0
backbone.backbone.dark3.1.m.0.conv1
backbone.backbone.dark3.1.m.0.conv1.conv
backbone.backbone.dark3.1.m.0.conv1.bn
backbone.backbone.dark3.1.m.0.conv1.act
backbone.backbone.dark3.1.m.0.conv2
backbone.backbone.dark3.1.m.0.conv2.conv
backbone.backbone.dark3.1.m.0.conv2.bn
backbone.backbone.dark3.1.m.0.conv2.act
backbone.backbone.dark4
backbone.backbone.dark4.0
backbone.backbone.dark4.0.conv
backbone.backbone.dark4.0.bn
backbone.backbone.dark4.0.act
backbone.backbone.dark4.1
backbone.backbone.dark4.1.conv1
backbone.backbone.dark4.1.conv1.conv
backbone.backbone.dark4.1.conv1.bn
backbone.backbone.dark4.1.conv1.act
backbone.backbone.dark4.1.conv2
backbone.backbone.dark4.1.conv2.conv
backbone.backbone.dark4.1.conv2.bn
backbone.backbone.dark4.1.conv2.act
backbone.backbone.dark4.1.conv3
backbone.backbone.dark4.1.conv3.conv
backbone.backbone.dark4.1.conv3.bn
backbone.backbone.dark4.1.conv3.act
backbone.backbone.dark4.1.m
backbone.backbone.dark4.1.m.0
backbone.backbone.dark4.1.m.0.conv1
backbone.backbone.dark4.1.m.0.conv1.conv
backbone.backbone.dark4.1.m.0.conv1.bn
backbone.backbone.dark4.1.m.0.conv1.act
backbone.backbone.dark4.1.m.0.conv2
backbone.backbone.dark4.1.m.0.conv2.conv
backbone.backbone.dark4.1.m.0.conv2.bn
backbone.backbone.dark4.1.m.0.conv2.act
backbone.backbone.dark5
backbone.backbone.dark5.0
backbone.backbone.dark5.0.conv
backbone.backbone.dark5.0.bn
backbone.backbone.dark5.0.act
backbone.backbone.dark5.1
backbone.backbone.dark5.1.conv1
backbone.backbone.dark5.1.conv1.conv
backbone.backbone.dark5.1.conv1.bn
backbone.backbone.dark5.1.conv1.act
backbone.backbone.dark5.1.m
backbone.backbone.dark5.1.m.0
backbone.backbone.dark5.1.m.1
backbone.backbone.dark5.1.m.2
backbone.backbone.dark5.1.conv2
backbone.backbone.dark5.1.conv2.conv
backbone.backbone.dark5.1.conv2.bn
backbone.backbone.dark5.1.conv2.act
backbone.backbone.dark5.2
backbone.backbone.dark5.2.conv1
backbone.backbone.dark5.2.conv1.conv
backbone.backbone.dark5.2.conv1.bn
backbone.backbone.dark5.2.conv1.act
backbone.backbone.dark5.2.conv2
backbone.backbone.dark5.2.conv2.conv
backbone.backbone.dark5.2.conv2.bn
backbone.backbone.dark5.2.conv2.act
backbone.backbone.dark5.2.conv3
backbone.backbone.dark5.2.conv3.conv
backbone.backbone.dark5.2.conv3.bn
backbone.backbone.dark5.2.conv3.act
backbone.backbone.dark5.2.m
backbone.backbone.dark5.2.m.0
backbone.backbone.dark5.2.m.0.conv1
backbone.backbone.dark5.2.m.0.conv1.conv
backbone.backbone.dark5.2.m.0.conv1.bn
backbone.backbone.dark5.2.m.0.conv1.act
backbone.backbone.dark5.2.m.0.conv2
backbone.backbone.dark5.2.m.0.conv2.conv
backbone.backbone.dark5.2.m.0.conv2.bn
backbone.backbone.dark5.2.m.0.conv2.act
backbone.upsample
backbone.lateral_conv0
backbone.lateral_conv0.conv
backbone.lateral_conv0.bn
backbone.lateral_conv0.act
backbone.C3_p4
backbone.C3_p4.conv1
backbone.C3_p4.conv1.conv
backbone.C3_p4.conv1.bn
backbone.C3_p4.conv1.act
backbone.C3_p4.conv2
backbone.C3_p4.conv2.conv
backbone.C3_p4.conv2.bn
backbone.C3_p4.conv2.act
backbone.C3_p4.conv3
backbone.C3_p4.conv3.conv
backbone.C3_p4.conv3.bn
backbone.C3_p4.conv3.act
backbone.C3_p4.m
backbone.C3_p4.m.0
backbone.C3_p4.m.0.conv1
backbone.C3_p4.m.0.conv1.conv
backbone.C3_p4.m.0.conv1.bn
backbone.C3_p4.m.0.conv1.act
backbone.C3_p4.m.0.conv2
backbone.C3_p4.m.0.conv2.conv
backbone.C3_p4.m.0.conv2.bn
backbone.C3_p4.m.0.conv2.act
backbone.reduce_conv1
backbone.reduce_conv1.conv
backbone.reduce_conv1.bn
backbone.reduce_conv1.act
backbone.C3_p3
backbone.C3_p3.conv1
backbone.C3_p3.conv1.conv
backbone.C3_p3.conv1.bn
backbone.C3_p3.conv1.act
backbone.C3_p3.conv2
backbone.C3_p3.conv2.conv
backbone.C3_p3.conv2.bn
backbone.C3_p3.conv2.act
backbone.C3_p3.conv3
backbone.C3_p3.conv3.conv
backbone.C3_p3.conv3.bn
backbone.C3_p3.conv3.act
backbone.C3_p3.m
backbone.C3_p3.m.0
backbone.C3_p3.m.0.conv1
backbone.C3_p3.m.0.conv1.conv
backbone.C3_p3.m.0.conv1.bn
backbone.C3_p3.m.0.conv1.act
backbone.C3_p3.m.0.conv2
backbone.C3_p3.m.0.conv2.conv
backbone.C3_p3.m.0.conv2.bn
backbone.C3_p3.m.0.conv2.act
backbone.bu_conv2
backbone.bu_conv2.conv
backbone.bu_conv2.bn
backbone.bu_conv2.act
backbone.C3_n3
backbone.C3_n3.conv1
backbone.C3_n3.conv1.conv
backbone.C3_n3.conv1.bn
backbone.C3_n3.conv1.act
backbone.C3_n3.conv2
backbone.C3_n3.conv2.conv
backbone.C3_n3.conv2.bn
backbone.C3_n3.conv2.act
backbone.C3_n3.conv3
backbone.C3_n3.conv3.conv
backbone.C3_n3.conv3.bn
backbone.C3_n3.conv3.act
backbone.C3_n3.m
backbone.C3_n3.m.0
backbone.C3_n3.m.0.conv1
backbone.C3_n3.m.0.conv1.conv
backbone.C3_n3.m.0.conv1.bn
backbone.C3_n3.m.0.conv1.act
backbone.C3_n3.m.0.conv2
backbone.C3_n3.m.0.conv2.conv
backbone.C3_n3.m.0.conv2.bn
backbone.C3_n3.m.0.conv2.act
backbone.bu_conv1
backbone.bu_conv1.conv
backbone.bu_conv1.bn
backbone.bu_conv1.act
backbone.C3_n4
backbone.C3_n4.conv1
backbone.C3_n4.conv1.conv
backbone.C3_n4.conv1.bn
backbone.C3_n4.conv1.act
backbone.C3_n4.conv2
backbone.C3_n4.conv2.conv
backbone.C3_n4.conv2.bn
backbone.C3_n4.conv2.act
backbone.C3_n4.conv3
backbone.C3_n4.conv3.conv
backbone.C3_n4.conv3.bn
backbone.C3_n4.conv3.act
backbone.C3_n4.m
backbone.C3_n4.m.0
backbone.C3_n4.m.0.conv1
backbone.C3_n4.m.0.conv1.conv
backbone.C3_n4.m.0.conv1.bn
backbone.C3_n4.m.0.conv1.act
backbone.C3_n4.m.0.conv2
backbone.C3_n4.m.0.conv2.conv
backbone.C3_n4.m.0.conv2.bn
backbone.C3_n4.m.0.conv2.act
head
head.cls_convs
head.cls_convs.0
head.cls_convs.0.0
head.cls_convs.0.0.conv
head.cls_convs.0.0.bn
head.cls_convs.0.0.act
head.cls_convs.0.1
head.cls_convs.0.1.conv
head.cls_convs.0.1.bn
head.cls_convs.0.1.act
head.cls_convs.1
head.cls_convs.1.0
head.cls_convs.1.0.conv
head.cls_convs.1.0.bn
head.cls_convs.1.0.act
head.cls_convs.1.1
head.cls_convs.1.1.conv
head.cls_convs.1.1.bn
head.cls_convs.1.1.act
head.cls_convs.2
head.cls_convs.2.0
head.cls_convs.2.0.conv
head.cls_convs.2.0.bn
head.cls_convs.2.0.act
head.cls_convs.2.1
head.cls_convs.2.1.conv
head.cls_convs.2.1.bn
head.cls_convs.2.1.act
head.reg_convs
head.reg_convs.0
head.reg_convs.0.0
head.reg_convs.0.0.conv
head.reg_convs.0.0.bn
head.reg_convs.0.0.act
head.reg_convs.0.1
head.reg_convs.0.1.conv
head.reg_convs.0.1.bn
head.reg_convs.0.1.act
head.reg_convs.1
head.reg_convs.1.0
head.reg_convs.1.0.conv
head.reg_convs.1.0.bn
head.reg_convs.1.0.act
head.reg_convs.1.1
head.reg_convs.1.1.conv
head.reg_convs.1.1.bn
head.reg_convs.1.1.act
head.reg_convs.2
head.reg_convs.2.0
head.reg_convs.2.0.conv
head.reg_convs.2.0.bn
head.reg_convs.2.0.act
head.reg_convs.2.1
head.reg_convs.2.1.conv
head.reg_convs.2.1.bn
head.reg_convs.2.1.act
head.cls_preds
head.cls_preds.0
head.cls_preds.1
head.cls_preds.2
head.reg_preds
head.reg_preds.0
head.reg_preds.1
head.reg_preds.2
head.obj_preds
head.obj_preds.0
head.obj_preds.1
head.obj_preds.2
head.stems
head.stems.0
head.stems.0.conv
head.stems.0.bn
head.stems.0.act
head.stems.1
head.stems.1.conv
head.stems.1.bn
head.stems.1.act
head.stems.2
head.stems.2.conv
head.stems.2.bn
head.stems.2.act
head.l1_loss
head.bcewithlog_loss
head.iou_loss
head.iou_loss
backbone.backbone.dark2.0.dconv backbone.backbone.dark2.0.conv
Traceback (most recent call last):
  File "prun_train/prune.py", line 255, in <module>
    main(exp,args)
  File "prun_train/prune.py", line 221, in main
    loose_model, prune_mask_dict, prune_bn_dict, mask_bn_channel_dict)
  File "prun_train/prune.py", line 112, in init_weights_from_loose_model
    assert loose_name == pruned_name, print(loose_name, pruned_name)
AssertionError: None
done
